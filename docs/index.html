<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>MCP Research Tool Docs</title>
    <style>
      :root {
        --bg: #0b1020;
        --bg-accent: #070a14;
        --panel: #101a33;
        --panel-alt: #0f1730;
        --line: rgba(255, 255, 255, 0.12);
        --ink: #e7ecff;
        --muted: #aab3d6;
        --brand: #7aa2ff;
        --brand-soft: rgba(122, 162, 255, 0.16);
      }

      * {
        box-sizing: border-box;
      }

      body {
        margin: 0;
        min-height: 100vh;
        font-family: "Space Grotesk", "Avenir Next", "Trebuchet MS", sans-serif;
        color: var(--ink);
        background: linear-gradient(180deg, var(--bg), var(--bg-accent));
      }

      .top-nav {
        position: sticky;
        top: 0;
        z-index: 30;
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 14px;
        padding: 10px 14px;
        background: color-mix(in oklab, var(--panel) 84%, #08101f 16%);
        border-bottom: 1px solid var(--line);
        backdrop-filter: blur(8px);
      }

      .top-nav-title {
        font-family: "Fraunces", "Iowan Old Style", "Times New Roman", serif;
        font-size: 18px;
        font-weight: 700;
        letter-spacing: 0.2px;
      }

      .top-nav-links {
        display: flex;
        align-items: center;
        gap: 8px;
      }

      .top-nav-link,
      .top-nav-summary {
        border: 1px solid var(--line);
        background: color-mix(in oklab, var(--panel-alt) 88%, #081022 12%);
        color: var(--ink);
        text-decoration: none;
        border-radius: 10px;
        padding: 7px 10px;
        font-size: 12px;
        font-weight: 600;
        cursor: pointer;
        display: inline-flex;
        align-items: center;
        gap: 6px;
      }

      .top-nav-link:hover,
      .top-nav-summary:hover {
        border-color: color-mix(in oklab, var(--brand) 50%, var(--line));
      }

      .top-nav-dropdown {
        position: relative;
      }

      .top-nav-dropdown > summary {
        list-style: none;
      }

      .top-nav-dropdown > summary::-webkit-details-marker {
        display: none;
      }

      .top-nav-menu {
        position: absolute;
        right: 0;
        top: calc(100% + 6px);
        min-width: 230px;
        border: 1px solid var(--line);
        border-radius: 12px;
        background: color-mix(in oklab, var(--panel) 92%, #091126 8%);
        box-shadow: 0 12px 26px rgba(0, 0, 0, 0.35);
        padding: 6px;
        display: grid;
        gap: 4px;
      }

      .top-nav-menu a {
        color: var(--ink);
        text-decoration: none;
        border-radius: 8px;
        padding: 8px 9px;
        font-size: 12px;
      }

      .top-nav-menu a:hover {
        background: color-mix(in oklab, var(--brand-soft) 76%, #0e1831 24%);
      }

      .shell {
        max-width: 1080px;
        margin: 0 auto;
        padding: 16px;
      }

      h1 {
        margin: 0;
        font-family: "Fraunces", "Iowan Old Style", "Times New Roman", serif;
      }

      .subtle {
        color: var(--muted);
        margin-top: 8px;
      }

      .panel {
        margin-top: 16px;
        border: 1px solid var(--line);
        border-radius: 12px;
        background: color-mix(in oklab, var(--panel) 92%, #091126 8%);
        padding: 16px;
        box-shadow: 0 10px 24px rgba(0, 0, 0, 0.22);
      }

      .markdown-body {
        font-size: 14px;
        line-height: 1.6;
      }

      .markdown-body > *:first-child {
        margin-top: 0;
      }

      .markdown-body > *:last-child {
        margin-bottom: 0;
      }

      .markdown-body h1,
      .markdown-body h2,
      .markdown-body h3,
      .markdown-body h4 {
        font-family: "Fraunces", "Iowan Old Style", "Times New Roman", serif;
        line-height: 1.25;
        margin: 1.1em 0 0.45em;
      }

      .markdown-body p,
      .markdown-body ul,
      .markdown-body ol,
      .markdown-body pre,
      .markdown-body blockquote {
        margin: 0 0 0.85em;
      }

      .markdown-body ul,
      .markdown-body ol {
        padding-left: 1.3em;
      }

      .markdown-body code {
        font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
        background: color-mix(in oklab, var(--panel-alt) 82%, #0a1328 18%);
        border: 1px solid var(--line);
        border-radius: 6px;
        padding: 0.1em 0.35em;
        font-size: 12px;
      }

      .markdown-body pre {
        background: color-mix(in oklab, var(--panel-alt) 84%, #0a1328 16%);
        border: 1px solid var(--line);
        border-radius: 10px;
        padding: 11px;
        overflow: auto;
      }

      .markdown-body pre code {
        border: none;
        padding: 0;
        background: transparent;
      }

      .markdown-body blockquote {
        border-left: 3px solid color-mix(in oklab, var(--brand) 50%, var(--line));
        margin-left: 0;
        padding-left: 10px;
        color: var(--muted);
      }

      a {
        color: var(--brand);
      }

      @media (max-width: 860px) {
        .top-nav {
          flex-direction: column;
          align-items: stretch;
        }

        .top-nav-links {
          flex-wrap: wrap;
        }

        .top-nav-dropdown {
          width: 100%;
        }

        .top-nav-summary,
        .top-nav-link {
          width: 100%;
          justify-content: center;
        }

        .top-nav-menu {
          position: static;
          margin-top: 6px;
          width: 100%;
        }
      }
    </style>
  </head>
  <body>
    <header class="top-nav">
      <div class="top-nav-title">MCP Research Tool</div>
      <nav class="top-nav-links" aria-label="Primary">
        <a class="top-nav-link" href="/">Dashboard</a>

        <details class="top-nav-dropdown">
          <summary class="top-nav-summary">Docs ▾</summary>
          <div class="top-nav-menu">
            <a href="/docs/?doc=README.md">README</a>
            <a href="/docs/?doc=tool-documentation.md">Tool Documentation</a>
            <a href="/docs/?doc=test-documentation.md">Test Documentation</a>
          </div>
        </details>

        <details class="top-nav-dropdown">
          <summary class="top-nav-summary">Developer Tools ▾</summary>
          <div class="top-nav-menu">
            <a href="/redisinsight/" onclick="window.open(this.href, '_blank', 'noopener,noreferrer'); return false;">RedisInsight</a>
            <a href="/minio/" onclick="window.open(this.href, '_blank', 'noopener,noreferrer'); return false;">MinIO Console</a>
            <a href="/qdrant/" onclick="window.open(this.href, '_blank', 'noopener,noreferrer'); return false;">Qdrant Dashboard</a>
            <a href="/flower/" onclick="window.open(this.href, '_blank', 'noopener,noreferrer'); return false;">Flower</a>
          </div>
        </details>
      </nav>
    </header>

    <main class="shell">
      <h1>MCP Research Documentation</h1>
      <p class="subtle">
        Source file:
        <a id="source-link" href="/docs/?doc=tool-documentation.md">tool-documentation.md</a>
      </p>
      <section class="panel">
        <article id="content" class="markdown-body">Loading documentation...</article>
      </section>
    </main>
    <script>
      function escapeHtml(text) {
        return text
          .replace(/&/g, "&amp;")
          .replace(/</g, "&lt;")
          .replace(/>/g, "&gt;");
      }

      function renderInline(markdown) {
        let text = escapeHtml(markdown);
        text = text.replace(/`([^`]+)`/g, "<code>$1</code>");
        text = text.replace(/\*\*([^*]+)\*\*/g, "<strong>$1</strong>");
        text = text.replace(/\*([^*]+)\*/g, "<em>$1</em>");
        text = text.replace(/\[([^\]]+)\]\(([^)]+)\)/g, '<a href="$2">$1</a>');
        return text;
      }

      function markdownToHtml(markdown) {
        const lines = markdown.replace(/\r\n/g, "\n").split("\n");
        const out = [];
        let inCode = false;
        let codeLines = [];
        let listType = null;

        function closeList() {
          if (!listType) return;
          out.push(listType === "ol" ? "</ol>" : "</ul>");
          listType = null;
        }

        for (const line of lines) {
          if (line.startsWith("```")) {
            closeList();
            if (!inCode) {
              inCode = true;
              codeLines = [];
            } else {
              out.push(`<pre><code>${escapeHtml(codeLines.join("\n"))}</code></pre>`);
              inCode = false;
              codeLines = [];
            }
            continue;
          }

          if (inCode) {
            codeLines.push(line);
            continue;
          }

          if (!line.trim()) {
            closeList();
            continue;
          }

          const heading = line.match(/^(#{1,4})\s+(.+)$/);
          if (heading) {
            closeList();
            const level = heading[1].length;
            out.push(`<h${level}>${renderInline(heading[2])}</h${level}>`);
            continue;
          }

          const blockquote = line.match(/^>\s?(.*)$/);
          if (blockquote) {
            closeList();
            out.push(`<blockquote>${renderInline(blockquote[1])}</blockquote>`);
            continue;
          }

          const ol = line.match(/^\d+\.\s+(.+)$/);
          if (ol) {
            if (listType !== "ol") {
              closeList();
              out.push("<ol>");
              listType = "ol";
            }
            out.push(`<li>${renderInline(ol[1])}</li>`);
            continue;
          }

          const ul = line.match(/^[-*]\s+(.+)$/);
          if (ul) {
            if (listType !== "ul") {
              closeList();
              out.push("<ul>");
              listType = "ul";
            }
            out.push(`<li>${renderInline(ul[1])}</li>`);
            continue;
          }

          closeList();
          out.push(`<p>${renderInline(line)}</p>`);
        }

        closeList();
        if (inCode) {
          out.push(`<pre><code>${escapeHtml(codeLines.join("\n"))}</code></pre>`);
        }
        return out.join("\n");
      }

      const docs = {
        "tool-documentation.md": "tool-documentation.md",
        "tool-documentation": "tool-documentation.md",
        "test-documentation.md": "test-documentation.md",
        "test-documentation": "test-documentation.md",
        "readme.md": "README.md",
        readme: "README.md",
      };

      const params = new URLSearchParams(window.location.search);
      const requested = (params.get("doc") || "tool-documentation.md").trim().toLowerCase();
      const selected = docs[requested] || "tool-documentation.md";
      const sourceLink = document.getElementById("source-link");
      if (sourceLink) {
        sourceLink.href = "/docs/?doc=" + encodeURIComponent(selected);
        sourceLink.textContent = selected;
      }

      fetch(selected)
        .then((response) => {
          if (!response.ok) {
            throw new Error("HTTP " + response.status);
          }
          return response.text();
        })
        .then((text) => {
          const target = document.getElementById("content");
          if (target) target.innerHTML = markdownToHtml(text);
        })
        .catch((error) => {
          const target = document.getElementById("content");
          if (target) target.textContent = "Failed to load documentation: " + error.message;
        });
    </script>
  </body>
</html>
